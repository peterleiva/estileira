////
/// This file describe mixins for mantain vertical rhythm
////

///
/// Adjust the component calculating the minimum length required to mantain the
/// rhythm
///
/// @param {Number} $font-size - font-size to be adjusted
/// @requires {function} lines-required - calculate the minimum lines required
/// @requires {function} measure-lines-rhythm - calculate the line length
///                                               required
///
@mixin adjust-component($font-size: $basesize) {
  font-size: $font-size;
  line-height: baseline-rhythm($font-size);
}

///
/// @alias adjust-component
/// @param {Number} $font-size - font-size to be adjusted
///
@mixin type-rhythm($font-size: $basesize) {
  @include adjust-component($font-size);
}

///
/// Scale a type mantaining vertical rhythm using modular scale
/// Uses a defined scale name in $type-scale or uses a number to be scale to
/// both of them using ms function
///
/// @param {Number | String} $scale - a scale or keyword defined by $type-scale
/// @requires {Map} $type-scale - scale naming map
/// @requires {function} ms - from modular scale library
@mixin type-scale($scale: 0) {
  $text-size: if(type-of($scale) == 'number', ms($scale),
                  ms(read-map($type-scale, $scale)));

  @include type-rhythm($text-size);
}

///
/// Iterate over each type name including in content argument
/// @requires {Map} $type-scale
///
@mixin type-scale-names {
  @each $size, $scale in $type-scale {
    @content($size);
  }
}

///
/// Apply vertical rhythm using padding list syntax
/// The rhythm is mantained calculating the lines required for each item list
///
/// @example
///   padding-rhythm(10 3 4 5)
///   padding-rhythm(10 5)
/// @param {List} $direction [()] - directions to be applied
///
@mixin padding-rhythm($sides: ()) {
  @include list-rhythm($sides) using ($pads) {
    padding: $pads;
  }
}

///
/// Maintain vertical rhythm applying margins using its list syntax
/// The rhythm is mantained calculating the lines required for each item list
///
/// @example
///   margin-rhythm(10 3 4 5)
///   margin-rhythm(10 5)
///
/// @param {List} $direction [()] - pad direction to be applied
///
@mixin margin-rhythm($sides: ()) {
  @include list-rhythm($sides) using ($margins) {
    margin: $margins;
  }
}

///
/// Applies rhythm for single margin side
///
/// @requires {function} side-rhythm
///
@mixin margin-side-rhythm($side, $lines: 1) {
  @include side-rhythm('margin', $side, $lines);
}

///
/// Applies rhythm for single padding side
///
/// @requires {function} side-rhythm
///
@mixin padding-side-rhythm($side, $lines: 1) {
  @include side-rhythm('padding', $side, $lines);
}

///
/// Calculates the single side line of margin or border property
///
/// @access private
/// @param {margin|padding} $property - property to be applies
/// @param {top|bottom|left|right} $side - side of property to be applies
/// @param {Number} $lines [1]
/// @requires {function} measure-lines-rhythm
/// @requires {List} $sides
///
@mixin side-rhythm($property, $side, $lines: 1) {
  @if index($sides, $side) == null {
    @error "The side rhythm #{$side} must be in #{$sides}";
  }

  $properties: ('margin' 'padding');

  @if index($properties, $property) == null {
    @error "Property #{$property} on side-rhythm must be in #{$properties}";
  }

  #{$property}-#{$side}: measure-lines-rhythm($lines);
}

///
/// Each direction calculates the line required for a list of
/// @throws error in case the list is empty
/// @access private
/// @param {List} $direction
/// @requires {function} list-lines-rhythm
///
@mixin list-rhythm($directions: ()) {
  @if length($directions) == 0 {
    @error "List shouldn't be empty";
  }

  @content(list-lines-rhythm($directions...));
}

///
/// Applies border to component keeping the vertical rhythm
/// The rhythm is mantained for each of four border width. Padding is added
/// calculating the leftover between the border with and the next baseline
///
/// @param {List} $sides [()] - borders side which applies the rhythm
/// @requires {function} padding-rhythm
/// @requires {function} baseline-rhythm
///
@mixin border-rhythm($sides: ()) {
  $pads: ();

  @include list-rhythm using ($borders) {
    border-width: $borders;

    @each $border in $borders {
      $pads: append($pads, baseline-rhythm($border) - $border);
    }

    @include padding-rhythm($pads);
  }
}

///
/// Applies rhythm for single padding side
///
/// @requires {function} measure-lines-rhythm
/// @requires {function} padding-side-rhythm
/// @requires {function} baseline-rhythm
///
@mixin border-side-rhythm($side, $width) {
  $border-width: measure-lines-rhythm($width);
  $padding: baseline-rhythm($border-width) - $border-width;

  border-width-#{$side}: $border-width;

  @if $padding > 0 {
    @include padding-side-rhythm($side, $padding);
  }
}

///
/// Aplica vertical rhythm to component
///
/// @example
///   a {
///     @include vertical-rhythm(1.2rem, $use-height: true, $bottom-rows: 1);
///   }
///
//// @access public
/// @param {$font-size} - Tamanho do elemento
///
// @mixin vertical-rhythm($font-size: $basesize){
//
//   // quantidade de linhas necessárias para o tamanho da letra
//   $min-lines: lines-required($font-size);
//
//   // altura que o elemento ocupa
//   $component-height: line-rhythm($min-lines);
//
//   // altura, em rem, do container
//   $height: line-rhythm(ceil($min-lines));
//
//   @if $use-height {
//     // sobras para que o elemento ocupe o número inteiro de linhas verticais
//     $leftover: $height - $component-height;
//     $pad: $leftover/2;
//     height: $component-height;
//     width: $component-height;
//     margin-top: $pad;
//     margin-bottom:$pad;
//   }
// }
